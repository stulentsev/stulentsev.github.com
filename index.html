
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Byte Friendly</title>
  <meta name="author" content="Sergio Tulentsev">

  
  <meta name="description" content="I&#8217;m into running lately. So quite often I do these calculations in my head &#8220;if I ran 10 secs/km faster, what distance would I have &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tech.tulentsev.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/ByteFriendly" rel="alternate" title="Byte Friendly" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script src="https://code.jquery.com/jquery-3.1.0.js"></script>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-203037-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Byte Friendly</a></h1>
  
    <h2>Random thoughts on programming and related topics.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/ByteFriendly" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tech.tulentsev.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2016/08/running-calculator-in-javascript/">Running Calculator in Javascript</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2016-08-26T14:23:00+03:00" pubdate data-updated="true">Aug 26<span>th</span>, 2016</time>
        
         | <a href="/2016/08/running-calculator-in-javascript/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;m into running lately. So quite often I do these calculations in my head &#8220;if I ran 10 secs/km faster, what distance would I have covered?&#8221; As the calculation are quite difficult and I am quite lazy, here&#8217;s a calculator that answers most of my questions. Posting it here for personal use, but maybe it&#8217;ll be useful to someone else too.</p>

<div>
  Time ([HH:]MM:SS) 
  <input id='txtTime' type='text' placeholder='How long is the run?' value='48:02' />
  <button class='calculate-btn' for='txtTime'>Calculate</button>
</div>


<p>x</p>

<div>
  Pace in mins/km (MM:SS)
  <input id='txtPace' type='text' placeholder='How fast do you go?' />
  <button class='calculate-btn' for='txtPace'>Calculate</button>
</div>


<p>=</p>

<div>
  Distance in kilometers
  <input id='txtDistance' type='text' placeholder='How far do you go?' value='10' />
  <button class='calculate-btn' for='txtDistance'>Calculate</button>
</div>




<script type='text/javascript'>
$(function() {
function padLeft(x) {
var str = "" + x;
return ('00'+str).substring(str.length);
}

function timeToSeconds(timestr) {
var parts = timestr.split(':').reverse();

var result = 0;
for(var i = 0; i < parts.length; i++) {
result += (parts[i] * Math.pow(60, i));
}

return result;
}

function secondsToTime(secs) {
var parts = [];

while(secs > 0){
var mod = secs % 60;
parts.push(padLeft(Math.floor(mod)));

secs = Math.floor(secs / 60);
}

return parts.reverse().join(':');
}

$('.calculate-btn').click(function() {
var time = timeToSeconds($('#txtTime').val());
var pace = timeToSeconds($('#txtPace').val());
var dist = $('#txtDistance').val();

var target = $(this).attr('for');
var result;

if(target === 'txtTime') {
result = dist * pace;
$('#txtTime').val(secondsToTime(result));
}

if(target === 'txtPace') {
result = time / dist;
$('#txtPace').val(secondsToTime(result));
}

if(target === 'txtDistance') {
result = time / pace;
var rounded = Math.round(result * 100) / 100;
$('#txtDistance').val(rounded);
}
})
});
</script>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2015/01/write-data-to-google-api-on-example-of-urlshortener-api/">Write Data to Google API on Example of UrlShortener API</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-11T19:19:00+03:00" pubdate data-updated="true">Jan 11<span>th</span>, 2015</time>
        
         | <a href="/2015/01/write-data-to-google-api-on-example-of-urlshortener-api/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I had some free time this weekend and wanted to mess around with Google API. Ultimately I wanted to work with Analytics, but decided to start with something simpler (like UrlShortener) to reduce possible beginner&#8217;s pain. I was fortunate to decide so, because I spent a couple of hours in debugging anyway.</p>

<p>Google API documentation is weird. It has this short <a href="https://developers.google.com/api-client-library/ruby/start/get_started#build">Getting Started</a> guide for Ruby, which contains only a few basic steps. <a href="https://developers.google.com/url-shortener/v1/getting_started?csw=1">Actual documentation</a> is expressed in the universal language of GET/POST requests (to be as language-agnostic as possible). A poor ruby newcomer is basically left to his own devices, there will be little to no help from google.</p>

<p>Let me share some things I learned. Basic consumption of an API looks like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;google/api_client&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">client</span> <span class="o">=</span> <span class="no">Google</span><span class="o">::</span><span class="no">APIClient</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>
</span><span class='line'><span class="n">urlshortener</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">discovered_api</span><span class="p">(</span><span class="s1">&#39;urlshortener&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">execute</span><span class="p">({</span>
</span><span class='line'>  <span class="n">api_method</span><span class="p">:</span> <span class="n">urlshortener</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">get</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">parameters</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>    <span class="n">shortUrl</span><span class="p">:</span> <span class="s1">&#39;http://goo.gl/fbsS&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>Looks simple, right? Yeah. It also doesn&#8217;t work. You&#8217;ll get an error when you try to run this.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">ArgumentError</span><span class="p">:</span> <span class="no">Missing</span> <span class="n">access</span> <span class="n">token</span><span class="o">.</span>
</span><span class='line'>  <span class="n">from</span> <span class="sr">/Users/se</span><span class="n">rgio</span><span class="o">/.</span><span class="n">gem</span><span class="o">/</span><span class="n">ruby</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">5</span><span class="o">/</span><span class="n">gems</span><span class="o">/</span><span class="n">signet</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">6</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">signet</span><span class="o">/</span><span class="n">oauth_2</span><span class="o">/</span><span class="n">client</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">1009</span><span class="ss">:in</span> <span class="sb">`generate_authenticated_request&#39;</span>
</span><span class='line'><span class="sb"> from /Users/sergio/.gem/ruby/2.1.5/gems/google-api-client-0.8.2/lib/google/api_client/request.rb:241:in `</span><span class="n">to_env</span><span class="err">&#39;</span>
</span><span class='line'>  <span class="o">.</span><span class="n">.</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>Documentation forgot to mention that you need to disable authorization in the client.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">client</span> <span class="o">=</span> <span class="no">Google</span><span class="o">::</span><span class="no">APIClient</span><span class="o">.</span><span class="n">new</span><span class="p">({</span>
</span><span class='line'>  <span class="n">authorization</span><span class="p">:</span> <span class="kp">nil</span><span class="p">,</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now, let&#8217;s say you want to shorten an url. This is <code>urlshortener.url.insert</code> method. Should be easy.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">client</span> <span class="o">=</span> <span class="no">Google</span><span class="o">::</span><span class="no">APIClient</span><span class="o">.</span><span class="n">new</span><span class="p">({</span>
</span><span class='line'>  <span class="n">authorization</span><span class="p">:</span> <span class="kp">nil</span><span class="p">,</span>
</span><span class='line'><span class="p">})</span>
</span><span class='line'>
</span><span class='line'><span class="n">urlshortener</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">discovered_api</span><span class="p">(</span><span class="s1">&#39;urlshortener&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">execute</span><span class="p">({</span>
</span><span class='line'>  <span class="n">api_method</span><span class="p">:</span> <span class="n">urlshortener</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">insert</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">parameters</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">longUrl</span><span class="p">:</span> <span class="s1">&#39;http://google.com&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p>But, instead of short url, you get this error in <code>result.data</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;error&quot;</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span><span class='line'>         <span class="s2">&quot;errors&quot;</span> <span class="o">=&gt;</span> <span class="o">[</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>                      <span class="s2">&quot;domain&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;global&quot;</span><span class="p">,</span>
</span><span class='line'>                      <span class="s2">&quot;reason&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;required&quot;</span><span class="p">,</span>
</span><span class='line'>                     <span class="s2">&quot;message&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Required&quot;</span><span class="p">,</span>
</span><span class='line'>                <span class="s2">&quot;locationType&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;parameter&quot;</span><span class="p">,</span>
</span><span class='line'>                    <span class="s2">&quot;location&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;resource.longUrl&quot;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="o">]</span><span class="p">,</span>
</span><span class='line'>           <span class="s2">&quot;code&quot;</span> <span class="o">=&gt;</span> <span class="mi">400</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;message&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Required&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>It looks like an error. And it seems to be saying that I somehow did not specify <code>longUrl</code> parameter. But I did! Also, what&#8217;s up with <code>resource</code> in <code>resource.longUrl</code>. After much googling, some more reading of their gem sources and some debugging on top of that, I was able to figure this out.</p>

<p>You see, <code>urlshortener.url.insert</code> is supposed to be a POST request. And it is correctly sent by the client gem. The only problem is with arguments. <code>parameters</code> key is what goes into query string for GET requests. But POST requests expect data in request body. Theoretically speaking, the gem could be smart enough to serialize <code>parameters</code> as a body if request method is &#8220;POST&#8221;. Sadly, it&#8217;s not the case. The secret is to use <code>body_object</code> key.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">execute</span><span class="p">({</span>
</span><span class='line'>  <span class="n">api_method</span><span class="p">:</span> <span class="n">urlshortener</span><span class="o">.</span><span class="n">url</span><span class="o">.</span><span class="n">insert</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">body_object</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">longUrl</span><span class="p">:</span> <span class="s1">&#39;http://google.com&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">})</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>body_object</code> will be serialized to request body. This will also set a correct &#8220;Content-Type&#8221; request header (&#8220;application/json&#8221;).</p>

<p>I spent several hours and didn&#8217;t find a hint of a hint to this in the docs. I know, maintaining good APIs is hard and maintaining good docs is even harder, but isn&#8217;t google supposed to be example to us all? :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/04/how-to-stop-capybara-integration-slash-feature-spec/">How to Freeze Capybara Integration/feature Spec</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-28T21:05:00+04:00" pubdate data-updated="true">Apr 28<span>th</span>, 2014</time>
        
         | <a href="/2014/04/how-to-stop-capybara-integration-slash-feature-spec/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I normally don&#8217;t write feature specs a lot, because usually the process is a bit of a pain. Especially when you&#8217;re trying to cover an existing legacy page with feature specs. Here&#8217;s one little trick that made my work a log easier, hopefully it will help you too :)</p>

<p>The problem is that sometimes the spec fails and you get a vague idea why (element by selector is not found or something like that), but by the time an error is printed, the browser window is long gone (you see the browser if you use selenium capybara driver, for example). So you want to pause a test and dig around, find out what goes wrong.</p>

<p>Capybara provides you with a <code>page</code> object which you can use to interact with the browser (click buttons, find elements, etc.), but I found it very inconvenient for quick poking around. Well, turns out (I didn&#8217;t know this before) that you can pause a test with something like <code>binding.pry</code> or <code>sleep</code>. Then you can inspect the page under test in the browser which will be left open and not frozen (it&#8217;s the separate process, so when main test process sleeps, browser is unaffected). Developer tools of modern browsers are fantastic, so it&#8217;s a shame not to use them.</p>

<p>Oh yes, you can also use this technique to do repeating test setup. Say, the business reports a bug to you, you want to test it, but you don&#8217;t want to keep a permanent feature spec (they&#8217;re dog slow). What you can do is create a temporary test that will set everything up (create three different types of accounts, two projects and what not) and just put a <code>binding.pry</code> at the end. From then you can tail <code>log/test.log</code> and test the site manually. After you&#8217;re done with the bug, you just delete the test and commit the changes.</p>

<p>Anyway, I hope this is googlable and will save somebody some time.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/04/how-to-make-custom-commands-in-atom-extensions/">How to Make Custom Commands in Atom Extensions</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-11T19:58:00+04:00" pubdate data-updated="true">Apr 11<span>th</span>, 2014</time>
        
         | <a href="/2014/04/how-to-make-custom-commands-in-atom-extensions/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>A couple of days ago I finally got my invite to <a href="http://atom.io">Atom editor</a>. A bit late, but I still was excited.</p>

<p>It makes overall positive impression and has some essential things bundled (save on lost focus, trim trailing whitespaces, etc.) But still there are some things lacking. So I decided to check out its praised extensibility.</p>

<p>Again, docs look good and cover some first steps. But I spent a good couple of hours today, trying to invoke my custom command.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">module.exports =</span>
</span><span class='line'>  <span class="nv">activate: </span><span class="nf">(state) -&gt;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nv">process: </span><span class="o">-&gt;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;doing custom action&#39;</span>
</span><span class='line'>    <span class="nv">editor = </span><span class="nx">atom</span><span class="p">.</span><span class="nx">workspace</span><span class="p">.</span><span class="nx">getActiveEditor</span><span class="p">()</span>
</span><span class='line'>    <span class="nx">editor</span><span class="p">.</span><span class="nx">insertText</span><span class="p">(</span><span class="s">&#39;hello&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p><code>process</code> in the listing above is a simple action. It gets current editor and inserts string &#8220;hello&#8221; at the cursor. I defined an editor shortcut, like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="err">&#39;.editor&#39;:</span>
</span><span class='line'>  <span class="err">&#39;cmd-ctrl-shift-e&#39;:</span> <span class="err">&#39;myext:process&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>where <code>myext</code> is the name of my extension. But upon pressing the hotkey, nothing happened. A couple of hours later I got the solution. My mistake was in assuming that Atom will somehow discover and dynamically call that exported method <code>process</code>. It&#8217;s exported for a reason, right? Well, no. It turns out that you have to bind commands manually.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='coffeescript'><span class='line'><span class="nv">module.exports =</span>
</span><span class='line'>  <span class="nv">activate: </span><span class="nf">(state) -&gt;</span>
</span><span class='line'>    <span class="nx">atom</span><span class="p">.</span><span class="nx">workspaceView</span><span class="p">.</span><span class="nx">command</span> <span class="s">&quot;myext:process&quot;</span><span class="p">,</span> <span class="o">=&gt;</span> <span class="nx">@process</span><span class="p">()</span>
</span><span class='line'>
</span><span class='line'>  <span class="nv">process: </span><span class="o">-&gt;</span>
</span><span class='line'>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s">&#39;doing custom action&#39;</span>
</span><span class='line'>    <span class="nv">editor = </span><span class="nx">atom</span><span class="p">.</span><span class="nx">workspace</span><span class="p">.</span><span class="nx">getActiveEditor</span><span class="p">()</span>
</span><span class='line'>    <span class="nx">editor</span><span class="p">.</span><span class="nx">insertText</span><span class="p">(</span><span class="s">&#39;hello&#39;</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Next time, we&#8217;ll do something useful. :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/04/work-with-large-yaml-files-and-not-go-crazy/">How to Work With Large YAML Files and Not Go Crazy</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-04T20:15:00+04:00" pubdate data-updated="true">Apr 4<span>th</span>, 2014</time>
        
         | <a href="/2014/04/work-with-large-yaml-files-and-not-go-crazy/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Large Rails apps have large locale .yml files. Some have files so large that it is not feasible to simply open them in editor and work with them. Sure, you can edit them just fine, but you can&#8217;t efficiently search them.</p>

<p>Say, you&#8217;re implementing a new page. It has &#8220;Balance&#8221; (for example) field on it. You think: &#8220;Hm, we have several other pages with this field. Surely, it had been I18n&#8217;d before. Let&#8217;s look in locale files&#8221;. You open 10 kLOC en-US.yml file, start searching and find 15 entries of &#8220;balance:&#8221; string, with varying levels of indentation. What are the full names of these keys? You have no idea.</p>

<p>I googled for quite a while and, to my surprise, haven&#8217;t found a yaml browser with search, which would show me FQN of a key. Here&#8217;s my little script that I wrote to help me in navigating these ginormous files:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1">#! /usr/bin/env ruby</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;yaml&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;colorize&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">filename</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
</span><span class='line'><span class="n">pattern_text</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="k">unless</span> <span class="n">filename</span> <span class="o">&amp;&amp;</span> <span class="n">pattern_text</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;Usage: grep_yaml.rb filename pattern&quot;</span>
</span><span class='line'>  <span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">pattern</span> <span class="o">=</span> <span class="no">Regexp</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">pattern_text</span><span class="p">,</span> <span class="ss">:nocase</span><span class="p">)</span>
</span><span class='line'><span class="nb">p</span> <span class="n">pattern</span>
</span><span class='line'>
</span><span class='line'><span class="nb">hash</span> <span class="o">=</span> <span class="no">YAML</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">recurse</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">current_path</span> <span class="o">=</span> <span class="o">[]</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_a?</span><span class="p">(</span><span class="nb">String</span><span class="p">)</span>
</span><span class='line'>    <span class="n">path</span> <span class="o">=</span> <span class="n">current_path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">obj</span> <span class="o">=~</span> <span class="n">pattern</span> <span class="o">||</span> <span class="n">path</span> <span class="o">=~</span> <span class="n">pattern</span>
</span><span class='line'>      <span class="k">yield</span> <span class="o">[</span><span class="n">path</span><span class="p">,</span> <span class="n">obj</span><span class="o">]</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">elsif</span> <span class="n">obj</span><span class="o">.</span><span class="n">is_a?</span><span class="p">(</span><span class="no">Hash</span><span class="p">)</span>
</span><span class='line'>    <span class="n">obj</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">|</span>
</span><span class='line'>      <span class="n">recurse</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">pattern</span><span class="p">,</span> <span class="n">current_path</span> <span class="o">+</span> <span class="o">[</span><span class="n">k</span><span class="o">]</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">recurse</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="n">pattern</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">path</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
</span><span class='line'>  <span class="n">line</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">path</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="si">#{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span> <span class="p">{</span><span class="o">|</span><span class="n">match</span><span class="o">|</span> <span class="n">match</span><span class="o">.</span><span class="n">green</span> <span class="p">}</span>
</span><span class='line'>  <span class="nb">puts</span> <span class="n">line</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Example usage (grep one of locale files of <a href="https://github.com/discourse/discourse">Discourse</a> project):</p>

<p><img class="center" src="/images/uploads/2014/04/04/yaml_grep.png"></p>

<p>Much more comfortable, isn&#8217;t it?</p>

<p>The source is uploaded as <a href="https://gist.github.com/stulentsev/9978365">gist</a>, for your copying/forking convenience. I should probably make a proper rubygem out of it. But, you know, when the immediate problem is solved, there are always more important things to work on. :/</p>

<p>Hope you find it useful.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/03/using-osx-notification-center-in-your-programs/">Using OSX Notification Center in Your Programs</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-17T20:50:00+04:00" pubdate data-updated="true">Mar 17<span>th</span>, 2014</time>
        
         | <a href="/2014/03/using-osx-notification-center-in-your-programs/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>There is this good feature in OSX, called <a href="http://en.wikipedia.org/wiki/Notification_Center">Notification Center</a> (which Apple may have stolen from Growl, who knows). It has an API, so you can post your events there. If you&#8217;re using Xcode and Apple frameworks, then you can stop reading now. However, if you&#8217;re programming in, say, ruby, you&#8217;re in much less fortunate position. There&#8217;s no official gem or library, so you are left on your own.</p>

<p>But don&#8217;t despair, we have you covered. There&#8217;s a cocoa app called <a href="https://github.com/alloy/terminal-notifier">terminal-notifier</a> that serves as a bridge between Notification Center and your app. It is accessible via command line and is quite configurable. There&#8217;s also a ruby gem that wraps this tool, but the main value is that it is available in command line. Which means that you can use it from whatever language you want. For example, I use it in my stackoverflow question poller which is written in <a href="http://golang.org/">Go</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/03/dash-now-with-cheatsheets/">Dash - Now With Cheatsheets</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-10T21:50:00+04:00" pubdate data-updated="true">Mar 10<span>th</span>, 2014</time>
        
         | <a href="/2014/03/dash-now-with-cheatsheets/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Just a couple of days ago I blogged about <a href="http://kapeli.com/dash">Dash</a>. And now they have released new major version, with (at least one) new feature: cheatsheets. One of the things I just can&#8217;t hold in my memory is HTTP status codes. I know 200 and 404, that&#8217;s it. All others I have to look up, every single time. And Dash has a cheatsheet for this, so I am covered here.</p>

<p>There is no cheatsheet for Vim, not even on its movements. But good news is: you can create your own: <a href="https://github.com/Kapeli/cheatset#readme">cheatset</a>.</p>

<p>I shall probably create one for TextMate key shortcuts (I should know most of them by now, I guess). We&#8217;ll see.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/03/useful-documentation-lookup-tools/">Useful Documentation Lookup Tools</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-03-04T23:20:00+04:00" pubdate data-updated="true">Mar 4<span>th</span>, 2014</time>
        
         | <a href="/2014/03/useful-documentation-lookup-tools/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Today I just wanted to share some tools that I use to read documentation.</p>

<p>First one is <a href="http://kapeli.com/dash">Dash</a>. It&#8217;s an offline documentation browser which contains many different topics. It has ruby, rails, CSS, HAML, jQuery, Go, Haskell and everything else you might want. It can also index locally installed rubygems. And did I mention that it is offline? If you&#8217;re anything like me, you need to consult documentation every 30 seconds. And with this tool you can even work on a plane! Can&#8217;t recommend enough.</p>

<p>Another one is for ruby only, <a href="http://www.omniref.com/">OmniRef</a>. These guys have indexed every ruby gem there is and cross-linked the documentation. On the site you can <em>easily</em> switch between version of a gem (or ruby) and see how documented behaviour and/or code changed over time. It also allows leaving notes (user generated content?), but I don&#8217;t see many notes at the moment. Potentially, these comments can be an excellent complement to the official documentation (we see this with, say, MySQL docs).</p>

<p>And, of course, the most important tool for me these days is <a href="http://stackoverflow.com">StackOverflow</a>. More than half of my google searches lead to this chest of collective programming wisdom. The funniest moments are when I struggle with something, then google points me to stackoverflow where I find an answer that <em>I posted myself</em> some time ago. Can you believe this? :)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/02/limitations-of-mongodb/">Limitations of MongoDB</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-25T13:18:00+04:00" pubdate data-updated="true">Feb 25<span>th</span>, 2014</time>
        
         | <a href="/2014/02/limitations-of-mongodb/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>MongoDB is becoming even more popular than it is now. More people want to learn about it. So I was preparing a seminar for this company and I had to compile a list of MongoDB limits. I never knew there were so many! Some of them are reasonable, some are weird. Anyway, it&#8217;s good to know them. Here&#8217;s a list of MongoDB limits as of version 2.4.9:</p>

<ul>
<li>Max document size: 16 MB (we all knew this one, right?)</li>
<li>Max document nesting level: 100 (documents inside documents inside documents&#8230;)</li>
<li>Namespace is limited to ~123 chars (namespace is db_name + collection_name (or index_name))</li>
<li>DB name is limited to 64 chars</li>
<li>Default .ns file can store about 24000 namespaces (again, a namespace is referring to a collection or an index)</li>
<li>If you index some field, that field can&#8217;t contain more than 1024 bytes</li>
<li>Max 64 indexes per collection</li>
<li>Max 31 fields in a compound index</li>
<li>fulltext search and geo indexes are mutually exclusive (you can&#8217;t use both in the same query)</li>
<li>If you set a limit of documents in a capped collection, this limit can&#8217;t be more than 2**32. Otherwise, number of documents is unlimited.</li>
<li>On linux, one mongod instance can&#8217;t store more than 64 TB of data (128 TB without journal)</li>
<li>On windows, mongod can&#8217;t store more than 4 TB of data (8 TB without journal)</li>
<li>Max 12 nodes in a replica set</li>
<li>Max 7 voting nodes in a replica set</li>
<li>You can&#8217;t automatically rollback more than 300 MB of data. If you have more than this, manual invervention is needed.</li>
<li><code>group</code> command doesn&#8217;t work in sharded cluster.</li>
<li>db.eval() doesn&#8217;t work on sharded collections. Works on unsharded, though.</li>
<li><code>$isolated</code>, <code>$snapshot</code>, geoSearch don&#8217;t work in a sharded cluster.</li>
<li>You can&#8217;t refer <code>db</code> object in <code>$where</code> functions.</li>
<li>If you want to shard a collection, it must be smaller than 256 GB, or else it will likely fail to shard.</li>
<li>Individual (not multi) updates/removes in a sharded cluster must include shard key. Multi versions of these commands may not include shard key.</li>
<li>Max 512 bytes for shard key values</li>
<li>You can&#8217;t change shard key for a collection once it&#8217;s sharded.</li>
<li>You can&#8217;t change value of a shard key of a document.</li>
<li>aggregate/$sort produces error if sorting takes more than 10 percent of RAM.</li>
<li>You can&#8217;t use $or in 2d geo queries</li>
<li>You better not use queries with multiple $in parts. If this results in more than 4 million combinations - you get error.</li>
<li>Database names are case-sensitive (even on case-insensitive file systems)</li>
<li>Forbidden characters in database names: linux - /. &#8220;, windows - /. &#8220;*&lt;>:|?</li>
<li>Forbidden characters in collection names: $ sign, &#8220;system.&#8221; prefix</li>
<li>Forbidden characters in field names: .$</li>
<li>Hashed index can&#8217;t be unique</li>
<li>Max connection number is hardcoded to 20k.</li>
</ul>


<p>Hope this was useful to you.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/02/kata-convert-numbers-to-roman-numerals/">Kata: Convert Numbers to Roman Numerals</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-08T10:24:00+04:00" pubdate data-updated="true">Feb 8<span>th</span>, 2014</time>
        
         | <a href="/2014/02/kata-convert-numbers-to-roman-numerals/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here is an interesting problem: write a program that converts numbers into <a href="http://en.wikipedia.org/wiki/Roman_numerals">Roman numerals</a>. Roman didn&#8217;t use Arabic numbers. Instead they used symbols of Latin alphabet that represented different values. It&#8217;s a simple system. &#8220;I&#8221; stands for 1, &#8220;V&#8221; stands for 5, &#8220;X&#8221; for 10 and so on. To represent 2 you have to use &#8220;II&#8221; (1 + 1), to represent 7 you use &#8220;VII&#8221; (5 + 1 + 1). Simple, right? Well, no. Here&#8217;s a twist.</p>

<pre>
* 4 is "IV" (not "IIII")
* 9 is "IX" (not "VIIII")
* 40 is "XL" (not "XXXX")
* 49 is "XLIX" (not "XXXXVIIII")
</pre>


<p>Weird, huh? Maybe they didn&#8217;t like 4 identical symbols in a row, who knows. Anyway, how can we solve this?</p>

<p>After trying out several &#8220;smart&#8221; solutions and failing, I&#8217;ve come up with this simple solution: store these special cases along with normal ones and keep subtracting from the number until it&#8217;s zero.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">romanize</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
</span><span class='line'>  <span class="n">reductions</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>    <span class="mi">1000</span> <span class="o">=&gt;</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">900</span> <span class="o">=&gt;</span> <span class="s1">&#39;CM&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="mi">500</span> <span class="o">=&gt;</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">400</span> <span class="o">=&gt;</span> <span class="s1">&#39;CD&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="mi">100</span> <span class="o">=&gt;</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">90</span> <span class="o">=&gt;</span> <span class="s1">&#39;XC&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="mi">50</span> <span class="o">=&gt;</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">40</span> <span class="o">=&gt;</span> <span class="s1">&#39;XL&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="mi">10</span> <span class="o">=&gt;</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">9</span> <span class="o">=&gt;</span> <span class="s1">&#39;IX&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="mi">5</span> <span class="o">=&gt;</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="mi">4</span> <span class="o">=&gt;</span> <span class="s1">&#39;IV&#39;</span><span class="p">,</span>
</span><span class='line'>
</span><span class='line'>    <span class="mi">1</span> <span class="o">=&gt;</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">while</span> <span class="n">number</span> <span class="o">&gt;</span> <span class="mi">0</span>
</span><span class='line'>    <span class="n">reductions</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">n</span><span class="p">,</span> <span class="n">subst</span><span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="n">number</span> <span class="o">/</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="c1"># if number contains at least one of n</span>
</span><span class='line'>        <span class="n">result</span> <span class="o">&lt;&lt;</span> <span class="n">subst</span>  <span class="c1"># push corresponding symbol to result</span>
</span><span class='line'>        <span class="n">number</span> <span class="o">-=</span> <span class="n">n</span>
</span><span class='line'>        <span class="k">break</span>            <span class="c1"># break from each and start it anew </span>
</span><span class='line'>                         <span class="c1"># so that the largest numbers are checked first again.</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">result</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>A test:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">test_mapping</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="mi">1</span> <span class="o">=&gt;</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">2</span> <span class="o">=&gt;</span> <span class="s1">&#39;II&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">3</span> <span class="o">=&gt;</span> <span class="s1">&#39;III&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">4</span> <span class="o">=&gt;</span> <span class="s1">&#39;IV&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">5</span> <span class="o">=&gt;</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">6</span> <span class="o">=&gt;</span> <span class="s1">&#39;VI&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">7</span> <span class="o">=&gt;</span> <span class="s1">&#39;VII&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">8</span> <span class="o">=&gt;</span> <span class="s1">&#39;VIII&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">9</span> <span class="o">=&gt;</span> <span class="s1">&#39;IX&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">10</span> <span class="o">=&gt;</span> <span class="s1">&#39;X&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">11</span> <span class="o">=&gt;</span> <span class="s1">&#39;XI&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">12</span> <span class="o">=&gt;</span> <span class="s1">&#39;XII&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">13</span> <span class="o">=&gt;</span> <span class="s1">&#39;XIII&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">14</span> <span class="o">=&gt;</span> <span class="s1">&#39;XIV&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">15</span> <span class="o">=&gt;</span> <span class="s1">&#39;XV&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">19</span> <span class="o">=&gt;</span> <span class="s1">&#39;XIX&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">22</span> <span class="o">=&gt;</span> <span class="s1">&#39;XXII&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">29</span> <span class="o">=&gt;</span> <span class="s1">&#39;XXIX&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">30</span> <span class="o">=&gt;</span> <span class="s1">&#39;XXX&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">40</span> <span class="o">=&gt;</span> <span class="s1">&#39;XL&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">49</span> <span class="o">=&gt;</span> <span class="s1">&#39;XLIX&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">99</span> <span class="o">=&gt;</span> <span class="s1">&#39;XCIX&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">950</span> <span class="o">=&gt;</span> <span class="s1">&#39;CML&#39;</span><span class="p">,</span>
</span><span class='line'>  <span class="mi">2014</span> <span class="o">=&gt;</span> <span class="s1">&#39;MMXIV&#39;</span><span class="p">,</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="n">test_mapping</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">|</span>
</span><span class='line'>  <span class="n">res</span> <span class="o">=</span> <span class="n">romanize</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</span><span class='line'>  <span class="n">sign</span> <span class="o">=</span> <span class="n">res</span> <span class="o">==</span> <span class="n">v</span> <span class="p">?</span> <span class="s1">&#39;.&#39;</span> <span class="p">:</span> <span class="s1">&#39;F&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nb">puts</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">sign</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="n">k</span><span class="si">}</span><span class="s2"> =&gt; </span><span class="si">#{</span><span class="n">res</span><span class="o">.</span><span class="n">inspect</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This simple problem took me a little bit over 2 hours to come up with this (simple) solution. Too bad, that often we, programmers, don&#8217;t have time to look for simple solutions and we go for the easiest one.</p>

<p>Hope this helps someone.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/2016/08/running-calculator-in-javascript/">Running calculator in Javascript</a>
      </li>
    
      <li class="post">
        <a href="/2015/01/write-data-to-google-api-on-example-of-urlshortener-api/">Write data to Google API on example of UrlShortener API</a>
      </li>
    
      <li class="post">
        <a href="/2014/04/how-to-stop-capybara-integration-slash-feature-spec/">How to freeze capybara integration/feature spec</a>
      </li>
    
      <li class="post">
        <a href="/2014/04/how-to-make-custom-commands-in-atom-extensions/">How to make custom commands in Atom extensions</a>
      </li>
    
      <li class="post">
        <a href="/2014/04/work-with-large-yaml-files-and-not-go-crazy/">How To Work with large YAML files and not go crazy</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Twitter</h1>
<a class="twitter-timeline" href="https://twitter.com/stulentsev" data-widget-id="443278503488675840">Tweets by @stulentsev</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

</section>  


<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/115058022574940748667?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Sergio Tulentsev -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'software-and-computers';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







</body>
</html>
